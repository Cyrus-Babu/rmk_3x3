[keyboard]
name = "Wave3x3"
product_name = "WaveZero Macropad"
vendor_id = 0x4c4b
product_id = 0x4602
manufacturer = "RMK User"
chip = "esp32s3"

[matrix]
rows = 3
cols = 3
# Matches the wiring table above
input_pins = ["GPIO1", "GPIO2", "GPIO3"]
output_pins = ["GPIO4", "GPIO5", "GPIO6"]

# THE ROTARY ENCODER SETUP
# Pin A = GPIO6, Pin B = GPIO7
# The "Button" (GPIO8) is treated as just another switch in the matrix?
# NO: It's easier to wire the encoder button into the matrix as a 10th key
# But if it's separate, we can use direct pin.
# PRO TIP: Wire the Encoder Button as "Row 0, Col 3" (extend matrix) or just a direct pin.
# Let's assume you wire the Encoder Button to GPIO8 connecting to GND (Direct Pin).
direct_pins = ["GPIO8"]

[layout]
# Layer 0: Volume Control + Standard Keys
# The 10th key is the Encoder Button (Direct Pin), set to toggle Layer 1
keymap = [
    [
        ["LC(LS(KC_X))", "F4", "F11"],
        ["PrintScreen", "AudioMute", "Calculator"],
        ["F5", "WwwSearch", "MediaPlayPause"],
        ["TG(1)"]  # The Encoder Button: Toggles Layer 1 on/off
    ],
    # Layer 1: Brightness Control
    [
        ["_", "_", "_"],
        ["_", "_", "_"],
        ["_", "LAlt(F4)", "_"],
        ["TG(1)"]  # Pressing button again goes back to Layer 0
    ]
]

[sensor]
# Encoder Setup
encoder_pad_a_pins = ["GPIO6"]
encoder_pad_b_pins = ["GPIO7"]
resolution = 2 # Usually 2 or 4 pulses per detent

# Sensor map: Behavior matches the layers above
# Layer 0: Volume Up/Down
# Layer 1: Brightness Up/Down
sensor_map = [
    [ ["KC_VOLU", "KC_VOLD"] ], 
    [ ["KC_BRIU", "KC_BRID"] ] 
]

[ble]
enabled = true
name = "Macropad"
battery_adc_pin = "GPIO9"
