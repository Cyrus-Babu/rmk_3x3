[keyboard]
name = "Wave3x3"
product_name = "WaveZero Macropad"
vendor_id = 0x4c4b
product_id = 0x4602
manufacturer = "RMK User"
chip = "esp32s3"

[matrix]

# Matches the wiring table above
row_pins = ["GPIO1", "GPIO2", "GPIO3","GPIO4"]
col_pins = ["GPIO5", "GPIO6","GPIO7"]

# THE ROTARY ENCODER SETUP
# Pin A = GPIO6, Pin B = GPIO7
# The "Button" (GPIO8) is treated as just another switch in the matrix?
# NO: It's easier to wire the encoder button into the matrix as a 10th key
# But if it's separate, we can use direct pin.
# PRO TIP: Wire the Encoder Button as "Row 0, Col 3" (extend matrix) or just a direct pin.
# Let's assume you wire the Encoder Button to GPIO8 connecting to GND (Direct Pin).
[layout]
rows = 4
cols = 3
layers=2
# Layer 0: Volume Control + Standard Keys
# The 10th key is the Encoder Button (Direct Pin), set to toggle Layer 1
keymap = [
    [
        ["LC(LS(KC_X))", "F4", "F11"],
        ["PrintScreen", "AudioMute", "Calculator"],
        ["F5", "WwwSearch", "MediaPlayPause"],
        ["TG(1)","_","_"]  # The Encoder Button: Toggles Layer 1 on/off
    ],
    # Layer 1: Brightness Control
    [
        ["_", "_", "_"],
        ["_", "_", "_"],
        ["_", "LAlt(F4)", "_"],
        ["TG(1)","_","_"]  # Pressing button again goes back to Layer 0
    ]
]
[[input_device.encoder]]
pin_a = "GPIO6"
pin_b = "GPIO7"
resolution = 2
[sensor]
 # Usually 2 or 4 pulses per detent

# Sensor map: Behavior matches the layers above
# Layer 0: Volume Up/Down
# Layer 1: Brightness Up/Down
encoder_map = [
    [ ["AudioVolUp", "AudioVolDown"] ], 
    [ ["BrightnessUp", "BrightnessDown"] ] 
]

[ble]
enabled = true
battery_adc_pin = "GPIO9"
